From a57438c9ef20fe3c3c1b9a087764d60bb7b97d44 Mon Sep 17 00:00:00 2001
From: Jari Aalto <jari.aalto@cante.net>
Date: Wed, 19 Sep 2012 10:01:26 +0300
Subject: [PATCH] Add CPAN module check
Organization: Private
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

Signed-off-by: Jari Aalto <jari.aalto@cante.net>
---
 sendxmpp |   21 +++++++++++++++++++++
 1 files changed, 21 insertions(+), 0 deletions(-)

diff --git a/sendxmpp b/sendxmpp
index b78fbc2..100c9bb 100755
--- a/sendxmpp
+++ b/sendxmpp
@@ -19,6 +19,27 @@ if 0; # not running under some shell
 # $Platon: sendxmpp/sendxmpp,v 1.22 2010-10-03 19:36:35 rajo Exp $
 # $Id: $
 
+# CPAN MODULES
+
+BEGIN
+{
+    my @list;
+
+    for (  'Authen::SASL', 'Net::XMPP' )
+    {
+        eval "use $_;" ;
+        push @list, $_   if $@;  # Eval error
+    }
+
+    if ( @list )
+    {
+        die q([FATAL] Perl CPAN modules are needed. Please install them with:
+
+perl -MCPAN -e 'install $_ for @ARGV' ) . qq(@list\n);
+
+    }
+}
+
 use Authen::SASL qw(Perl); # authentication broken if Authen::SASL::Cyrus module installed
 use Net::XMPP;
 use Getopt::Long;
-- 
1.7.9

